# 第一部分 研究概述
## 研究背景
- 首先讲一下研究背景。
- 研究背景主要是由建筑生成设计方法的发展出发，扩展到具体的现有建筑群体布局方法与工具以及图论与拓扑关系理论在建筑生成设计中的运用上。
- 针对这几个部分相关研究中的不足做一个梳理，然后尝试在研究中针对方法通用性，生成结果的几何形态单一，以及拓扑关系利用不足这些问题做一些调整和改进。

## 文献研究
- 按照上述的现有建筑群体布局方法与工具以及图论与拓扑关系理论在建筑生成设计中的运用这两部分内容，对相关研究进行了归纳整理，得到了如下的思路以及对应关系。

- 建筑设计过程中所常用的泡泡图，就是空间关系图的一种。它主要用来表示空间的组织关系。它与建筑平面图之间的关系如图所示。建筑空间关系图中的顶点是被视为房间、区域或者是实体；图结构中的边被视为是房间、区域或者是实体之间的连接关系；边的权重被视为是连接关系的重要程度；边的方向可以被视为是不同房间、区域或者实体之间的流线。
- 建筑平面图在简化掉标注等信息后可以在抽象层面上也把它视为是一个图结构，这种代表平面几何特征的图可以看作是建筑平面图的拓扑图。它与建筑平面图之间的关系如图所示。建筑平面图上墙体或边界之间的交点被视为是图结构中的顶点；墙体或边界则被视为是图结构中的边；墙体或边界的长度和尺寸可以被视为是图结构中边所带有的权重。
- 建筑平面图的拓扑图与建筑空间关系图两者互为对偶图
- 从建筑平面图的拓扑图与建筑空间关系图出发的研究可以对应的分为两种思路
  1. 以建筑空间关系图作为工具的布局生成思路
  2. 以建筑平面图的拓扑图作为工具的布局生成思路
- 而这两种思路，又可以与建筑群体自动布局相关研究中的两种思路对应。
  1. 从建筑体量本身的放置布局入手的思路，可以理解为把代表体量的关系图中的顶点布置在场地之上
  2. 从建筑体量所占据场地空间的划分入手的思路，可以理解为将场地划分平面图的拓扑图转化为实际场地划分平面图的过程
     在本研究中，采用的是下面这个思路。

## 研究框架
- 研究框架部分中第一章和第二章的内容也是按照刚才所述的逻辑展开叙述的。
- 第三章主要处理由空间关系图到实际场地划分平面图的过程。
- 第四章主要是基于实际场地划分平面图得到具体的建筑群体体量布局的过程。
- 三四章的内容都将在本次汇报的第二部分 方法构建部分进行详细说明
- 第五六章主要是进行不同尺度不同形状场地上的建筑群体体量布局生成实验来说明生成工具的有效性，以及进行整个生成方法流程的相关总结。
- 五六章的内容将在生成实验和总结与回顾部分进行说明。

# 第二部分 方法构建
## 图结构组织与场地划分方法部分
- 首先是第三章部分，由空间关系图到实际场地划分平面图的过程。整体的方法流程如图所示。主要由图结构操作模块和场地区域划分模块两部分构成，最终输出实际场地的划分结果作为第四章的输入。
  1. 从空间关系图入手，
  1. 引入代表北东西南场地边界的NEWS节点将输入的拓扑连接关系转化为包含体量（或区域）与体量（或区域）、体量（或区域）与场地边界之间关系的松散约束的空间关系图。
  1. 基于该松散约束的空间关系图的平面无交叉展开形态，穷尽该松散的空间关系图中所有的未进行严格定义的连接关系，得到若干各个节点间连接关系完全确定的紧凑约束的空间关系图。
  4. 将该紧凑约束的空间关系图转化为对偶图。接着以场地划分平面图的拓扑图作为工具，建立由空间关系图的对偶图到实际场地划分平面图的对应关系得到最终场地划分的结果。
     每个模块所包含的内容，如图框所示。

### 图结构操作模块
#### 拓扑关系的表示与转化
- 主要是将输入的邻接表转化为可视化的图结构结果

#### 空间关系图的平面展开
- 主要是利用TutteEmbedding算法快速将有交叉的图结构结果展开成平面无交叉的形态，以便于对于输入拓扑关系的检查和后续对于图结构计算的相关操作。

#### 空间关系图中未预定义的拓扑关系穷尽
- 对于没有在输入阶段获取到的连接关系（如图中的绿色虚线），我们将他视为一种隐含的拓扑可能性。这些可能性作为最终解空间的一部分，需要设计相关算法进行穷尽。

#### 空间关系图的对偶图生成
- 在得到完整的空间关系图后，根据对偶图的定义来生成对偶图。

### 场地区域划分模块
#### 原有场地边界条件处理
- 针对不同的场地边界条件，需要进行统一化形式的处理，包括场地边界的方位对应，以及不规则场地缺口的完形补全。

#### 由空间关系图的对偶图生成场地划分平面图的拓扑图的边界部分
- 将对偶图的边缘按照顶点和方位对应规则生成场地划分平面图的拓扑图的边界部分。这个过程可以想象成类似一个帆布的固定过程，首先需要找到对应的锚点进行固定。对偶图边界上的每个点都是锚点。

#### 由场地划分算法生成场地划分平面图的拓扑图
- 基于场地划分平面图的拓扑图的边界部分，按照具体的划分算法生成整个场地划分平面图的拓扑图。这个过程就像是在固定锚点后要怎样去绷紧帆布的过程。可以看到划分结果都能稳定保持原来的拓扑关系。并且对于复杂的拓扑关系也能够应对。

#### 由场地划分平面图的拓扑图得到实际场地划分结果
- 基于曲面uv映射的原理，将场地划分平面图的拓扑图转化为实际场地划分平面图。

## 体量布局生成方法部分
- 第四章的部分，基于实际场地划分平面图得到具体的建筑群体体量布局的过程。整体的方法流程如图所示.主要由地块区域连接与退线控制模块，体量布局基准线生成模块，以及体量布局生成模块三部分，最终输出建筑群体体量布局结果。
  1. 地块区域连接与退线控制模块主要是按照拓扑关系的约束以及边界的位置来进行退线距离的控制
  1. 体量布局基准线生成主要是在间距条件的约束下得到可以进行体量布局的基本位置
  1. 体量布局生成基于基准线同时考虑建筑形态，容积率以及建筑密度等约束，得到最终的体量生成结果

### 地块区域连接与退线控制
- 主要基于之前部分中的空间关系图到平面图的拓扑图的转换过程，找到连接关系所对应的拓扑图中的边的位置，并按照对应的退线距离进行不等距退线操作。

### 体量布局基准线的生成
#### 子地块分割
- 将L形的地块分割形成两个四边形地块。在过程中区分了面宽方向与进深方向两种不同的处理方式。

#### 进深方向布局基准线生成以及面宽方向布局基准线生成
- 通过对常用体量形式的归纳分析，对于多层体量以及高层体量，我们可以归纳为”口“字形及其变体以及集中式布局这几种形式。同时考虑到生成体量对于不同场地形状的适应性，本研究选择基于体量布局基准线来进行布局。
- 首先定义布局基准线体系中的相关变量，按照规则先进行进深方向上的布局基准线生成，后进行面宽方向上的布局基准线生成。

#### 布局基准线的截断与长度约束
- 截断是指进深方向的布局基准线被面宽方向上的布局基准线截断。长度约束是指，如果出现长度大于最大面宽的情况，就予以截断处理。

### 体量生成及其约束控制
#### 多层及高层部分体量形态控制
- 基于布局基准线所形成的”口“字形以及由两个”口“字形所拼合形成的”8“字形，进一步演化得到变体形态。这些形态作为体量平面布局的基本形态。
- 这些形态都是由布局基准线生成而来，这不只是由简单的中心线两侧偏移而得到的，而是要考虑具体的场地形态，需要做一定的切割处理。
- 对于集中式的布局也是基于”口“字形或”8“字形边界进行偏移得到的，并且只会生成在角部。

#### 体量指标控制
- 基于上述形态控制的规则，我们融入指标控制的规则。通过平面削减的过程实现对于建筑密度的约束和控制。在该削减过程中，优先保证进深方向上的体量能够得到保留，同一规则层级内削减体量的位置是随机的，直到所约束的建筑密度较小使得体量只能生成集中式的布局。
- 基于满足建筑密度约束的平面轮廓，我们可以生成满足容积率约束的体量。在这里我们区分了普通的多层模式，以及多层高层混合模式。对于多层高层混合模式，我们需要额外输入多层部分与高层部分的比例，以达到面积分配的目的。
- 这是一些不同尺度用地条件下的生成结果。

# 第三部分 生成实验
- 首先进行了综合体尺度的建筑群体体量布局生成实验。该实验主要验证生成工具在较小尺度，不规则形状的场地条件上进行布局生成的能力。相关实验参数的设定均参照一般设计经验以及江苏省城市规划管理技术规定的相关内容。拓扑连接关系的设定按照背景介绍中的部分进行设置。该案例的场地条件并不十分复杂，选择该案例的主要目的是为了说明生成工具对于拓扑关系的处理能力。
- 从生成结果中可以看到空间关系图以及与之对应的场地划分平面图的拓扑图之间的联系，以及对应到具体实际场地条件上的体量布局结果。这四个方案的空间关系图均不同（不同的部分在于绿色虚线，即未预定义的拓扑关系），所得到的生成结果在场地边界处的朝向也不同。
- 对于多组图尺度的建筑群体体量布局生成实验。该实验主要验证生成工具在较大尺度，不规则形状的场地条件上进行布局生成的能力。相关实验参数的设定均参照一般设计经验以及江苏省城市规划管理技术规定的相关内容。拓扑连接关系的设定按照背景介绍中的部分进行设置。该案例的场地形状为不规则凹多边形，选择该案例的主要目的是为了说明生成工具对于不规则场地的处理能力以及生成结果的形体多样性。
- 从生成结果中可以看到，首先针对场地的缺口部分通过完形补全的方式进行了处理，使得不同条件的场地能够按照相同的生成步骤和算法进行生成。在空间关系图以及与之对应的场地划分平面图的拓扑图相同时，也能够得到形态各异的生成结果。

# 第四部分 总结与回顾
- 主要研究成果首先是建立了空间关系图的对偶图到场地划分平面图的拓扑图之间的对应关系，更进一步通过场地划分平面图的拓扑图得到实际场地划分的平面图结果。该方法可以进一步拓展到其他与拓扑关系相关的使用场景中。其次是基于体量布局基准线实现多种形式的多层模式及多层高层混合模式的建筑群体体量布局生成，使得整个由空间关系图到建筑群体体量布局的过程完整。
- 最后是生成方法对于不同尺度，不同形状用地的通用性和适应性。这些也是本研究对于研究背景部分所发现问题的回应。
- 另外，本研究在指标控制部分存在一定的偏差，指标控制并不十分精准。所编写的生成程序也存在一定的错误和异常。也需要针对具体的建筑类型和寻优算法做进一步的开发工作。程序的可操作性和交互性也有待提高，可以进一步整合优化进行窗口化。
